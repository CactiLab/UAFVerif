<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:latexdraw="http://latexdraw.sourceforge.net/namespaces/latexdraw" version="1.1" baseProfile="full">
    <g>
        <g latexdraw:type="joinedLines" id="id1864213760">
            <polyline points="1124.9757267270797,69.91887747892933 1124.9757267270797,964.7235587185324 1124.9757267270797,964.7235587185324 " stroke-width="1.0" stroke="black" fill="none" latexdraw:rotationAngle="0.0"/>
        </g>
        <g latexdraw:type="joinedLines" id="id1318015554">
            <polyline points="572.7250170338408,65.54054054054046 572.4272857655146,963.4896447556071 572.4272857655146,963.4896447556071 " stroke-width="1.0" stroke="black" fill="none" latexdraw:rotationAngle="0.0"/>
        </g>
        <g latexdraw:type="joinedLines" id="id59442856">
            <polyline points="22.104360796482613,65.00000000000011 21.81532865969848,964.7159614820631 21.81532865969848,964.7159614820631 " stroke-width="1.0" stroke="black" fill="none" latexdraw:rotationAngle="0.0"/>
        </g>
        <g latexdraw:type="rectangle" id="id915669015">
            <rect x="-50.66666666666674" y="39.88888888888914" width="145.2222222222224" height="32.4444444444448" latexdraw:borderPos="outer" stroke-width="2.0" stroke="#e8e8e8" fill="#e5e5e5"/>
        </g>
        <g latexdraw:type="text" id="id826713008" fill="black" latexdraw:position="bl">
            <text x="-43.760683760684074" y="66.1111111111104">\emph{AAID, $sk_{AT}$, $k_{W}$}</text>
        </g>
        <g latexdraw:type="rectangle" id="id1340835544">
            <rect x="529.3333333333333" y="39.88888888888914" width="95.2222222222224" height="32.4444444444448" latexdraw:borderPos="outer" stroke-width="2.0" stroke="#e8e8e8" fill="#e5e5e5"/>
        </g>
        <g latexdraw:type="text" id="id1509660476" fill="black" latexdraw:position="bl">
            <text x="547.7777777777779" y="61.111111111110404">\emph{FacetID}</text>
        </g>
        <g latexdraw:type="rectangle" id="id1244989341">
            <rect x="1034.627450980392" y="41.45751633986947" width="180.41830065359522" height="32.4444444444448" latexdraw:borderPos="outer" stroke-width="2.0" stroke="#e8e8e8" fill="#e5e5e5"/>
        </g>
        <g latexdraw:type="text" id="id733522224" fill="black" latexdraw:position="bl">
            <text x="1041.699346405229" y="66.11111111111063">\emph{UName, AppID, $pk_{AT}$}</text>
        </g>
        <g latexdraw:type="text" id="id1294650106" fill="black" latexdraw:position="tl">
            <text x="-38.88888888888886" y="15.722222222222172">\textbf{Authenticator}</text>
        </g>
        <g latexdraw:type="text" id="id1909818146" fill="black" latexdraw:position="tl">
            <text x="806.1111111111112" y="12.722222222222172">\textbf{User Agent}</text>
        </g>
        <g latexdraw:type="text" id="id962760303" fill="black" latexdraw:position="tl">
            <text x="1061.1111111111113" y="12.222222222222172">\textbf{Relying Party}</text>
        </g>
        <g latexdraw:type="rectangle" id="id1956891993">
            <rect x="1035.9022988505744" y="188.1819923371645" width="181.22222222222263" height="48.44444444444525" latexdraw:borderPos="outer" stroke-width="1.0" stroke="black" fill="white"/>
        </g>
        <g latexdraw:type="text" id="id23135362" fill="black" latexdraw:position="bl">
            <text x="1052.0689655172418" y="230.45977011494278">\texttt{new random} \emph{Chlg}</text>
        </g>
        <g latexdraw:type="rectangle" id="id1807927538">
            <rect x="411.0747126436786" y="280.9406130268201" width="331.2222222222217" height="123.44444444444389" latexdraw:borderPos="outer" stroke-width="1.0" stroke="black" fill="white"/>
        </g>
        <g latexdraw:type="text" id="id474525343" fill="black" latexdraw:position="bl">
            <text x="427.3754789272037" y="396.55172413793116">\emph{fcp} $\leftarrow$ $\langle$\emph{AppID, Chlg, TLSData}$\rangle$
</text>
        </g>
        <g latexdraw:type="joinedLines" id="id629475999">
            <polyline points="1118.4482758620688,269.65517241379325 853.4482758620688,269.65517241379325 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-629475999)"/>
        </g>
        <g latexdraw:type="text" id="id80480925" fill="black" latexdraw:position="bl">
            <text x="877.3927203065135" y="268.5440613026823"> \emph{UName, AppID, SData, Chlg} 
</text>
        </g>
        <g latexdraw:type="text" id="id462526400" fill="black" latexdraw:position="bl">
            <text x="81.927519804599" y="523.8888888888889"> \emph{ UName, AppID, ak, fc } 
</text>
        </g>
        <g latexdraw:type="text" id="id1530869935" fill="black" latexdraw:position="bl">
            <text x="78.7439613526567" y="698.0193236714974"> \emph{AAID, fc, KeyID} 
</text>
        </g>
        <g latexdraw:type="text" id="id1154792442" fill="black" latexdraw:position="bl">
            <text x="1052.0689655172418" y="205.45977011494278">\texttt{new random} \emph{SData}</text>
        </g>
        <g latexdraw:type="joinedLines" id="id1884473632">
            <polyline points="293.4322751553332,525.539722992308 28.332430727019982,525.5713881188028 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-1884473632)"/>
        </g>
        <g latexdraw:type="joinedLines" id="id788163813">
            <polyline points="28.25874619921092,701.2083680518205 293.8888622856958,701.0138541704017 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-788163813)"/>
        </g>
        <g latexdraw:type="joinedLines" id="id273470710">
            <polyline points="580.4023254537683,701.8980232242344 845.4405864236269,701.7035093428157 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-273470710)"/>
        </g>
        <g latexdraw:type="text" id="id1198841263" fill="black" latexdraw:position="bl">
            <text x="427.888299440024" y="350.5004420866493">\texttt{get} \emph{TLSData} \texttt{from TLS channel}</text>
        </g>
        <g latexdraw:type="rectangle" id="id828984019">
            <rect x="-196.16666666666697" y="534.3888888888887" width="431.2222222222227" height="143.4444444444448" latexdraw:borderPos="outer" stroke-width="1.0" stroke="black" fill="white"/>
        </g>
        <g latexdraw:type="text" id="id730022623" fill="black" latexdraw:position="bl">
            <text x="-176.11111111111111" y="602.7777777777774">\texttt{new} $\langle$\emph{$sk_{AU}$, $pk_{AU}$}$\rangle$
</text>
        </g>
        <g latexdraw:type="text" id="id715449675" fill="black" latexdraw:position="bl">
            <text x="-177.28758169934625" y="628.3986928104571">\emph{KeyID} $\leftarrow$ \emph{h} $\leftarrow$ ${\texttt{E}}_{k_{W}}$(\emph{$sk_{AU}$, ak}, \emph{UName})</text>
        </g>
        <g latexdraw:type="text" id="id173455417" fill="black" latexdraw:position="bl">
            <text x="-176.11111111111111" y="649.4444444444448">\texttt{new sign counter} \emph{$CNTR_{A}$}</text>
        </g>
        <g latexdraw:type="text" id="id1781190148" fill="black" latexdraw:position="bl">
            <text x="-177.22222222222217" y="675.111111111112">\emph{S} $\leftarrow$ ${\texttt{sign}}_{sk_{AT}}$ (\emph{$AAID, fc, KeyID, CNTR_{A}, pk_{AU}$})</text>
        </g>
        <g latexdraw:type="text" id="id2053000964" fill="black" latexdraw:position="bl">
            <text x="-176.11111111111111" y="557.7777777777774">\emph{ak} $\leftarrow$ f1(\emph{ak, AppID})</text>
        </g>
        <g latexdraw:type="text" id="id1857132081" fill="black" latexdraw:position="bl">
            <text x="-176.11111111111111" y="577.7777777777774">\texttt{verify the user}</text>
        </g>
        <g latexdraw:type="text" id="id379488385" fill="black" latexdraw:position="bl">
            <text x="428.1447096964342" y="369.02608311229017">\emph{xSData} $\leftarrow$ \emph{SData}</text>
        </g>
        <g latexdraw:type="joinedLines" id="id2103847267">
            <polyline points="298.5093307593314,65.00000000000011 298.30769558710097,963.6688064923638 298.7521400315454,963.6688064923638 " stroke-width="1.0" stroke="black" fill="none" latexdraw:rotationAngle="0.0"/>
        </g>
        <g latexdraw:type="rectangle" id="id121448462">
            <rect x="209.33333333333303" y="39.88888888888914" width="180.22222222222263" height="32.4444444444448" latexdraw:borderPos="outer" stroke-width="2.0" stroke="#e8e8e8" fill="#e5e5e5"/>
        </g>
        <g latexdraw:type="text" id="id387554542" fill="black" latexdraw:position="bl">
            <text x="217.77777777777794" y="66.1111111111104">\emph{ASMToken, CallerID}</text>
        </g>
        <g latexdraw:type="rectangle" id="id2039135067">
            <rect x="128.83333333333348" y="444.38888888888914" width="341.2222222222222" height="53.44444444444389" latexdraw:borderPos="outer" stroke-width="1.0" stroke="black" fill="white"/>
        </g>
        <g latexdraw:type="text" id="id1712148949" fill="black" latexdraw:position="bl">
            <text x="139.44444444444463" y="470.0000000000002">\emph{fc} $\leftarrow$ \texttt{hash}(\emph{fcp})
</text>
        </g>
        <g latexdraw:type="text" id="id1224835270" fill="black" latexdraw:position="bl">
            <text x="139.87179487179492" y="491.83760683760727">\emph{ak} $\leftarrow$ \texttt{hash}(\emph{AppID, ASMToken, CallerID})
</text>
        </g>
        <g latexdraw:type="joinedLines" id="id913692240">
            <polyline points="848.9544817927177,63.43137254901938 848.7521400315454,962.7053310301169 848.7521400315454,962.7053310301169 " stroke-width="1.0" stroke="black" fill="none" latexdraw:rotationAngle="0.0"/>
        </g>
        <g latexdraw:type="rectangle" id="id2067473359">
            <rect x="789.3333333333333" y="39.88888888888914" width="125.2222222222224" height="32.4444444444448" latexdraw:borderPos="outer" stroke-width="2.0" stroke="#e8e8e8" fill="#e5e5e5"/>
        </g>
        <g latexdraw:type="joinedLines" id="id648420615">
            <polyline points="842.5388776200135,269.1379310344828 575.5780933062881,269.1379310344828 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-648420615)"/>
        </g>
        <g latexdraw:type="text" id="id422881834" fill="black" latexdraw:position="bl">
            <text x="600.1532567049811" y="268.0268199233718"> \emph{UName, AppID, SData, Chlg} 
</text>
        </g>
        <g latexdraw:type="text" id="id1913983948" fill="black" latexdraw:position="tl">
            <text x="526.1111111111112" y="15.722222222222172">\textbf{UAF Client}</text>
        </g>
        <g latexdraw:type="text" id="id714525975" fill="black" latexdraw:position="bl">
            <text x="428.32154435602735" y="304.85411140583597">\texttt{get trust facet list from} \emph{AppID}</text>
        </g>
        <g latexdraw:type="joinedLines" id="id1132595161">
            <polyline points="567.6470588235295,430.0 305.0,430.0 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-1132595161)"/>
        </g>
        <g latexdraw:type="text" id="id1771183838" fill="black" latexdraw:position="bl">
            <text x="387.2222222222225" y="428.888888888889"> \emph{UName, fcp} 
</text>
        </g>
        <g latexdraw:type="text" id="id1007733732" fill="black" latexdraw:position="tl">
            <text x="276.1111111111112" y="15.722222222222172">\textbf{ASM}</text>
        </g>
        <g latexdraw:type="joinedLines" id="id1305079807">
            <polyline points="304.98040712719694,701.2083680518205 568.8888622856957,701.0138541704017 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-1305079807)"/>
        </g>
        <g latexdraw:type="rectangle" id="id1711255734">
            <rect x="878.1436781609191" y="731.1130268199231" width="496.2222222222226" height="218.4444444444448" latexdraw:borderPos="outer" stroke-width="1.0" stroke="black" fill="white"/>
        </g>
        <g latexdraw:type="text" id="id1251918354" fill="black" latexdraw:position="bl">
            <text x="907.0881226053639" y="783.3908045977012">\emph{xfc} $\leftarrow$ \texttt{hash}(\emph{AppID, Chlg, TLSData})
</text>
        </g>
        <g latexdraw:type="text" id="id1572424086" fill="black" latexdraw:position="bl">
            <text x="889.8659003831417" y="800.0574712643679">\texttt{check}:</text>
        </g>
        <g latexdraw:type="text" id="id1234035859" fill="black" latexdraw:position="bl">
            <text x="906.5325670498083" y="827.2796934865901"> \emph{xSData} == \emph{SData}</text>
        </g>
        <g latexdraw:type="text" id="id1764426986" fill="black" latexdraw:position="bl">
            <text x="905.9770114942528" y="849.5019157088122">\emph{xfc} == \emph{fc}
</text>
        </g>
        <g latexdraw:type="text" id="id1126455927" fill="black" latexdraw:position="bl">
            <text x="889.8659003831417" y="898.3908045977012">\texttt{if right then}:</text>
        </g>
        <g latexdraw:type="text" id="id1146916922" fill="black" latexdraw:position="bl">
            <text x="908.7547892720306" y="945.6130268199233">\texttt{store} \emph{$pk_{AU}$, KeyID, AAID, $CNTR_{S}$}</text>
        </g>
        <g latexdraw:type="text" id="id474078168" fill="black" latexdraw:position="bl">
            <text x="908.7547892720306" y="923.6130268199233">$CNTR_{S} \leftarrow CNTR_{A}$</text>
        </g>
        <g latexdraw:type="text" id="id1192730473" fill="black" latexdraw:position="bl">
            <text x="907.0881226053639" y="758.3908045977012">\texttt{get} \emph{TLSData} \texttt{from TLS channel}</text>
        </g>
        <g latexdraw:type="text" id="id377594567" fill="black" latexdraw:position="bl">
            <text x="905.9770114942528" y="874.5019157088122"> ${\texttt{CheckSign}}_{pk_{AT}}$(\emph{S}, $\langle$\emph{$AAID, fc, KeyID, CNTR_{A}, pk_{AU}$}$\rangle$)
</text>
        </g>
        <g latexdraw:type="text" id="id1522334860" fill="black" latexdraw:position="bl">
            <text x="605.7351045489522" y="698.7089788439114"> \emph{xSData, AAID, fc, KeyID } 
</text>
        </g>
        <g latexdraw:type="joinedLines" id="id1528923920">
            <polyline points="859.1654438945479,702.9325059828549 1119.2861636350208,702.7379921014361 " stroke-width="1.0" stroke="black" latexdraw:rotationAngle="0.0" marker-end="url(#arrow1-1528923920)"/>
        </g>
        <g latexdraw:type="text" id="id501650924" fill="black" latexdraw:position="bl">
            <text x="886.718635729764" y="699.7434616025319"> \emph{xSData, AAID, fc, KeyID } 
</text>
        </g>
        <g latexdraw:type="rectangle" id="id1252563015">
            <rect x="11.311338503189177" y="961.4489106627229" width="21.684210526315837" height="5.894736842105203" latexdraw:borderPos="outer" stroke-width="2.0" stroke="black" fill="black"/>
        </g>
        <g latexdraw:type="rectangle" id="id780150524">
            <rect x="288.1901528013584" y="961.4489140151331" width="21.684210526315837" height="5.894736842105203" latexdraw:borderPos="outer" stroke-width="2.0" stroke="black" fill="black"/>
        </g>
        <g latexdraw:type="rectangle" id="id159663422">
            <rect x="562.867572156197" y="961.4489041707532" width="21.684210526315837" height="5.894736842105203" latexdraw:borderPos="outer" stroke-width="2.0" stroke="black" fill="black"/>
        </g>
        <g latexdraw:type="rectangle" id="id1934768957">
            <rect x="838.1901528013582" y="961.4489140151331" width="21.684210526315837" height="5.894736842105203" latexdraw:borderPos="outer" stroke-width="2.0" stroke="black" fill="black"/>
        </g>
        <g latexdraw:type="rectangle" id="id1531846087">
            <rect x="1113.7657378740969" y="961.4489164086685" width="21.684210526315837" height="5.894736842105203" latexdraw:borderPos="outer" stroke-width="2.0" stroke="black" fill="black"/>
        </g>
        <g latexdraw:type="text" id="id122524868" fill="black" latexdraw:position="bl">
            <text x="59.178743961352666" y="726.0628019323669"> \emph{ $CNTR_{A}$, $pk_{AU}$, S, $Cert_{AT}$} 
</text>
        </g>
        <g latexdraw:type="text" id="id1311433647" fill="black" latexdraw:position="bl">
            <text x="365.26570048309077" y="698.236714975845"> \emph{AAID, fc, KeyID} 
</text>
        </g>
        <g latexdraw:type="text" id="id1785660692" fill="black" latexdraw:position="bl">
            <text x="428.32154435602735" y="324.85411140583597">\texttt{check if} \emph{FacetID} \texttt{in the facet list}</text>
        </g>
        <g latexdraw:type="polygon" id="id1873400244">
            <polygon points="820.0,115.0 775.0,140.0 820.0,165.0 1165.0,165.0 1205.0,140.0 1165.0,115.0 " stroke-width="2.0" stroke="black" fill="white" latexdraw:rotationAngle="0.0"/>
        </g>
        <g latexdraw:type="text" id="id1164389342" fill="black" latexdraw:position="bl">
            <text x="805.2657004830908" y="148.23671497584496">\texttt{original login and trigger a registration}
</text>
        </g>
        <g latexdraw:type="text" id="id659017977" fill="black" latexdraw:position="bl">
            <text x="329.17874396135267" y="726.0628019323669"> \emph{ $CNTR_{A}$, $pk_{AU}$, S, $Cert_{AT}$} 
</text>
        </g>
        <g latexdraw:type="text" id="id1078399666" fill="black" latexdraw:position="bl">
            <text x="604.1787439613527" y="726.0628019323669"> \emph{ $CNTR_{A}$, $pk_{AU}$, S, $Cert_{AT}$} 
</text>
        </g>
        <g latexdraw:type="text" id="id1443884147" fill="black" latexdraw:position="bl">
            <text x="884.1787439613527" y="726.0628019323669"> \emph{ $CNTR_{A}$, $pk_{AU}$, S, $Cert_{AT}$} 
</text>
        </g>
    </g>
    <defs>
        <marker overflow="visible" orient="auto" id="arrow1-629475999">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-1884473632">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-788163813">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-273470710">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-648420615">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-1132595161">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-1305079807">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
        <marker overflow="visible" orient="auto" id="arrow1-1528923920">
            <path d="M 0.0 0.0 L -12.0 4.0 L -12.0 0.0 L -12.0 -4.0 z " latexdraw:arrSizeNum="4.0" fill="black"/>
        </marker>
    </defs>
    <metadata>
        <latexdraw:metadata>
            <latexdraw:latexIncludes>\usepackage{verbatim}
\usepackage{cprotect}
\usepackage{xcolor,listings}&#13;
\usepackage{multicol}
\usepackage{tikz}</latexdraw:latexIncludes>
            <latexdraw:displayXScale>false</latexdraw:displayXScale>
            <latexdraw:displayYScale>false</latexdraw:displayYScale>
            <latexdraw:unit>CM</latexdraw:unit>
            <latexdraw:zoom>1.1000000000000032</latexdraw:zoom>
            <latexdraw:magneticGridStyle>STANDARD</latexdraw:magneticGridStyle>
            <latexdraw:gridGap>10</latexdraw:gridGap>
            <latexdraw:magneticGrid>true</latexdraw:magneticGrid>
            <latexdraw:version>3.3.8</latexdraw:version>
            <latexdraw:size>
                <latexdraw:width>1616</latexdraw:width>
                <latexdraw:height>876</latexdraw:height>
            </latexdraw:size>
            <latexdraw:position>
                <latexdraw:x>0.0</latexdraw:x>
                <latexdraw:y>0.0</latexdraw:y>
            </latexdraw:position>
        </latexdraw:metadata>
    </metadata>
</svg>
